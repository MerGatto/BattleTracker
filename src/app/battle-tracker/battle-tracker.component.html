<div class="container-fluid">
  <div class="row">
    <table class="table table-striped table-bordered">
      <thead>
        <tr class="info row">
          <th class="col-md-2">
            {{"Name" | translate}}
          </th>
          <th class="col-md-1">
            {{"INI" | translate}}
          </th>
          <th class="col-md-1">
            {{"Input" | translate}}
          </th>
          <th class="col-md-1">
            {{"WM" | translate}}
          </th>
          <th class="col-md-1">
            {{"Temp" | translate}}
          </th>
          <th class="col-md-3">
            {{"Actions" | translate}}
          </th>
          <th class="col-md-1">
          </th>
          <th class="col-md-1">
          </th>
          <th class="col-md-1">
          </th>
        </tr>
      </thead>

      <tbody class="panel-body">
        <tr class="row" [ngClass]="getParticipantStyles(p)" *ngFor="let p of participants.items">
          <td>
            <input id="name" name="name" type="text" placeholder="Name" class="form-control input-md" (keydown)="inpName_KeyDown($event)" [(ngModel)]="p.name">
          </td>
          <td>
            <label class="control-label lblIni" for="ini">{{getInitiative(p)}} </label>
          </td>
          <td>
            <input class="form-control input-md inpIni" name="ini" type="number"(keydown)="inpIni_KeyDown($event)" (focus)="inp_Focus($event)" (input)="iniChange($event, p)" [(ngModel)]="p.ini" #field="ngModel" [min]="0">
          </td>
          <td>
            <input class="form-control input-md" name="wm" type="number" (focus)="inp_Focus($event)" (input)="wmChange($event, p)" [(ngModel)]="p.wm">
          </td>
          <td>
            <input class="form-control input-md" name="tmp" type="number" (focus)="inp_Focus($event)" [(ngModel)]="p.iniChange">
          </td>
          <td class="row">
            <button type="button" class="btn btn-default" (click)="btnEdge_Click(p)" *ngIf="!p.edge && (!started || (passEnded && getInitiative(p) > 10))">
              {{"Seize Initiative" | translate}}
            </button>
            <button type="button" class="btn btn-default" (click)="btnAct_Click(p)" *ngIf="started && (p.status == 1 || p.status == 2)">
              {{"Action" | translate}}
            </button>
            <button type="button" class="btn btn-default" (click)="btnDelay_Click(p)" *ngIf="started && p.status == 1">
              {{"Delay" | translate}}
            </button>
            <label class="btn btn-default" [class.active]="p.actions.fullDefense" *ngIf="started && getInitiative(p) > 1">
              <input type="checkbox" class="hide" [(ngModel)]="p.actions.fullDefense" (click)="actnBtn_Click()" [disabled]="started && p.actions.fullDefense">{{"fullDefense" | translate}}
            </label>
            <div class="btn-group" dropdown *ngIf="started && getInitiative(p) > 1">
              <button id="single-button" type="button" class="btn btn-primary" dropdownToggle>
                {{"Interrupts" | translate}} <span class="caret"></span>
              </button>
              <ul dropdownMenu role="menu" aria-labelledby="single-button">
                <li role="menuitem" class="buffer" *ngFor="let action of p.actions.persistentInterrupts">
                  <label class="dropdown-item btn btn-default btn-block" [class.active]="p.actions[action.key]">
                    <input type="checkbox" class="hide" [(ngModel)]="p.actions[action.key]" (click)="actnBtn_Click()" [disabled]="started && p.actions[action.key]">
                    {{action.key | translate}}
                  </label>
                </li>
                <li role="menuitem" class="buffer" *ngFor="let action of p.actions.normalInterrupts">
                  <button type="button" class="btn btn-default btn-block" (click)="actnBtn_Click(p, action)">
                    {{action.key | translate}}
                  </button>
                </li>
              </ul>
            </div>
          </td>
          <td>
            <button type="button" class="btn btn-default" (click)="btnEnterCombat_Click(p)" *ngIf="p.ooc">
              {{"Enter Combat" | translate}}
            </button>
            <button type="button" class="btn btn-default" (click)="btnLeaveCombat_Click(p)" *ngIf="!p.ooc">
              {{"Leave Combat" | translate}}
            </button>
          </td>
          <td>
            <button type="button" class="btn btn-default" (click)="btnDelete_Click(p)">
              {{"Delete" | translate}}
            </button>
          </td>
        </tr>
        <tr class="row">
          <td colspan="9">
            <button type="submit" class="btn btn-primary" (click)="btnAddParticipant_Click()"><span class="glyphicon glyphicon-plus"></span></button>
          </td>
        </tr>
      </tbody>
      <tfoot>
        <tr class="row">
          <td colspan="9">{{"Turn" | translate}} {{combatTurn}}, {{"Pass" | translate}} {{initiativeTurn}}</td>
        </tr>
      </tfoot>
    </table>
  </div>
  <div class="row">
    <button type="button" class="btn btn-primary" (click)="btnStartRound_Click()" *ngIf="!started">
      {{"Start Round" | translate}}
    </button>
    <button type="button" class="btn btn-primary" (click)="btnNextPass_Click()" *ngIf="started && passEnded">
      {{"Next Pass" | translate}}
    </button>
    <button type="button" class="btn btn-danger" (click)="btnReset_Click()">
      {{"Reset" | translate}}
    </button>
  </div>
  <div class="row buffer-top">
    <button type="button" class="btn btn-warning" (click)="btnUndo_Click(p)">
      {{"Undo" | translate}}
    </button>
    <button type="button" class="btn btn-warning" (click)="btnRedo_Click(p)">
      {{"Redo" | translate}}
    </button>
  </div>
</div>